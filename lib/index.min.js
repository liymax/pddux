!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],r):r(e.sudux={},e.React)}(this,function(e,c){"use strict";function l(e,r,n,t,o,i){var a,u,f,c,s;n&&(Array.isArray(o)?function(e,r,n,t,o,i){for(var a=Math.min(o.length,i.length),u=0;u<a;u++)if(e.assigned[u]&&o[u]!==i[u]){var f=r.concat(u);n.push({op:"replace",path:f,value:i[u]}),t.push({op:"replace",path:f,value:o[u]})}if(a<i.length){for(var c=a;c<i.length;c++){var s=r.concat(c);n.push({op:"add",path:s,value:i[c]})}t.push({op:"replace",path:r.concat("length"),value:o.length})}else if(a<o.length){n.push({op:"replace",path:r.concat("length"),value:i.length});for(var p=a;p<o.length;p++){var l=r.concat(p);t.push({op:"add",path:l,value:o[p]})}}}(e,r,n,t,o,i):(a=r,u=n,f=t,c=o,s=i,w(e.assigned,function(e,r){var n=c[e],t=s[e],o=r?e in c?"replace":"add":"remove";if(n!==c||"replace"!==o){var i=a.concat(e);u.push("remove"===o?{op:o,path:i}:{op:o,path:i,value:t}),f.push("add"===o?{op:"remove",path:i}:"remove"===o?{op:"add",path:i,value:n}:{op:"replace",path:i,value:n})}})))}c=c&&c.hasOwnProperty("default")?c.default:c;var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h="undefined"!=typeof Symbol?Symbol("immer-proxy-state"):"__$immer_state",s="An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.";var r=!("undefined"!=typeof process&&"production"===process.env.NODE_ENV||"verifyMinified"!==function(){}.name),v="undefined"!=typeof Proxy;function y(e){return!!e&&!!e[h]}function b(e){if(!e)return!1;if("object"!==(void 0===e?"undefined":d(e)))return!1;if(Array.isArray(e))return!0;var r=Object.getPrototypeOf(e);return null===r||r===Object.prototype}function g(e){return r&&Object.freeze(e),e}var n=Object.assign||function(e,r){for(var n in r)O(r,n)&&(e[n]=r[n]);return e};function m(e){if(Array.isArray(e))return e.slice();var r=void 0===e.__proto__?Object.create(null):{};return n(r,e)}function w(e,r){if(Array.isArray(e))for(var n=0;n<e.length;n++)r(n,e[n]);else for(var t in e)r(t,e[t])}function O(e,r){return Object.prototype.hasOwnProperty.call(e,r)}function j(e,r,n,t){if(y(e)){var o=e[h];if(!0===o.modified){if(!0===o.finalized)return o.copy;o.finalized=!0;var i=(a=v?o.copy:o.copy=m(e),f=r,c=n,s=t,p=(u=o).base,w(a,function(e,r){if(r!==p[e]){var n=c&&!O(u.assigned,e);a[e]=j(r,n&&f.concat(e),n&&c,s)}}),g(a));return l(o,r,n,t,o.base,i),i}return o.base}var a,u,f,c,s,p;return function n(t){if(!b(t))return;if(Object.isFrozen(t))return;w(t,function(e,r){y(r)?t[e]=j(r):n(r)});g(t)}(e),e}function p(e,r){return e===r?0!==e||1/e==1/r:e!=e&&r!=r}var E=null,i={get:function(e,r){if(r===h)return e;{if(e.modified){var n=e.copy[r];return n===e.base[r]&&b(n)?e.copy[r]=x(e,n):n}if(O(e.proxies,r))return e.proxies[r];var t=e.base[r];return!y(t)&&b(t)?e.proxies[r]=x(e,t):t}},has:function(e,r){return r in t(e)},ownKeys:function(e){return Reflect.ownKeys(t(e))},set:function(e,r,n){if(e.assigned[r]=!0,!e.modified){if(r in e.base&&p(e.base[r],n)||O(e.proxies,r)&&e.proxies[r]===n)return!0;o(e)}return e.copy[r]=n,!0},deleteProperty:function(e,r){return e.assigned[r]=!1,o(e),delete e.copy[r],!0},getOwnPropertyDescriptor:function(e,r){var n=e.modified?e.copy:O(e.proxies,r)?e.proxies:e.base,t=Reflect.getOwnPropertyDescriptor(n,r);!t||Array.isArray(n)&&"length"===r||(t.configurable=!0);return t},defineProperty:function(){throw new Error("Immer does not support defining properties on draft objects.")},setPrototypeOf:function(){throw new Error("Immer does not support `setPrototypeOf()`.")}},a={};function t(e){return!0===e.modified?e.copy:e.base}function o(e){e.modified||(e.modified=!0,e.copy=m(e.base),Object.assign(e.copy,e.proxies),e.parent&&o(e.parent))}function x(e,r,n){if(y(r))throw new Error("Immer bug. Plz report.");var t={modified:!1,assigned:{},finalized:!1,parent:e,base:r,copy:void 0,proxies:{}},o=Array.isArray(r)?Proxy.revocable([t],a):Proxy.revocable(t,i);return E.push(o),o.proxy}w(i,function(e,r){a[e]=function(){return arguments[0]=arguments[0][0],r.apply(this,arguments)}});var u={},P=null;function f(e){return e.hasCopy?e.copy:e.base}function A(e){e.modified||(e.modified=!0,e.parent&&A(e.parent))}function _(e){e.hasCopy||(e.hasCopy=!0,e.copy=m(e.base))}function S(e,r){var n=m(r);w(r,function(e){var r;Object.defineProperty(n,""+e,u[r=""+e]||(u[r]={configurable:!0,enumerable:!0,get:function(){return function(e,r){k(e);var n=f(e)[r];return!e.finalizing&&n===e.base[r]&&b(n)?(_(e),e.copy[r]=S(e,n)):n}(this[h],r)},set:function(e){!function(e,r,n){if(k(e),e.assigned[r]=!0,!e.modified){if(p(f(e)[r],n))return;A(e),_(e)}e.copy[r]=n}(this[h],r,e)}}))});var t,o,i,a={modified:!1,assigned:{},hasCopy:!1,parent:e,base:r,proxy:n,copy:void 0,finished:!1,finalizing:!1,finalized:!1};return t=n,o=h,i=a,Object.defineProperty(t,o,{value:i,enumerable:!1,writable:!0}),P.push(a),n}function k(e){if(!0===e.finished)throw new Error("Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+JSON.stringify(e.copy||e.base))}function C(e){if(e&&"object"===(void 0===e?"undefined":d(e))){var n=e[h];if(n){var r,t,o,i,a=n.proxy,u=n.base;if(Array.isArray(e)){if(z(n)){if(A(n),n.assigned.length=!0,a.length<u.length)for(var f=a.length;f<u.length;f++)n.assigned[f]=!1;else for(var c=u.length;c<a.length;c++)n.assigned[c]=!0;w(a,function(e,r){n.assigned[e]||C(r)})}}else{var s=(r=u,t=a,o=Object.keys(r),{added:(i=Object.keys(t)).filter(function(e){return-1===o.indexOf(e)}),removed:o.filter(function(e){return-1===i.indexOf(e)})}),p=s.added,l=s.removed;(0<p.length||0<l.length)&&A(n),w(p,function(e,r){n.assigned[r]=!0}),w(l,function(e,r){n.assigned[r]=!1}),w(a,function(e,r){n.assigned[e]||C(r)})}}}}function z(e){var r=e.proxy;if(r.length!==e.base.length)return!0;var n=Object.getOwnPropertyDescriptor(r,r.length-1);return!(!n||n.get)}function D(e,r,n){if(y(e)){var t=r.call(e,e);return void 0===t?e:t}var o=P;P=[];var i=n&&[],a=n&&[];try{var u=S(void 0,e),f=r.call(u,u);w(P,function(e,r){r.finalizing=!0});var c=void 0;if(void 0!==f&&f!==u){if(u[h].modified)throw new Error(s);c=j(f),i&&(i.push({op:"replace",path:[],value:c}),a.push({op:"replace",path:[],value:e}))}else n&&C(u),function(){for(var e=P.length-1;0<=e;e--){var r=P[e];!1===r.modified&&(Array.isArray(r.base)?z(r)&&A(r):(n=r,t=Object.keys(n.base),o=Object.keys(n.proxy),function(e,r){if(p(e,r))return!0;if("object"!==(void 0===e?"undefined":d(e))||null===e||"object"!==(void 0===r?"undefined":d(r))||null===r)return!1;var n=Object.keys(e),t=Object.keys(r);if(n.length!==t.length)return!1;for(var o=0;o<n.length;o++)if(!hasOwnProperty.call(r,n[o])||!p(e[n[o]],r[n[o]]))return!1;return!0}(t,o)||A(r)))}var n,t,o}(),c=j(u,[],i,a);return w(P,function(e,r){r.finished=!0}),n&&n(i,a),c}finally{P=o}}function R(e,r,n){if(arguments.length<1||3<arguments.length)throw new Error("produce expects 1 to 3 arguments, got "+arguments.length);if("function"==typeof e){if("function"==typeof r)throw new Error("if first argument is a function (curried invocation), the second argument to produce cannot be a function");var t=r,o=e;return function(){var r=arguments;return R(void 0===r[0]&&void 0!==t?t:r[0],function(e){return r[0]=e,o.apply(e,r)})}}if("function"!=typeof r)throw new Error("if first argument is not a function, the second argument to produce should be a function");if(void 0!==n&&"function"!=typeof n)throw new Error("the third argument of a producer should not be set or a function");if("object"!==(void 0===e?"undefined":d(e))||null===e){var i=r(e);return void 0===i?e:i}if(!b(e))throw new Error("the first argument to an immer producer should be a primitive, plain object or array, got "+(void 0===e?"undefined":d(e))+': "'+e+'"');return v?function(e,r,n){if(y(e)){var t=r.call(e,e);return void 0===t?e:t}var o=E;E=[];var i=n&&[],a=n&&[];try{var u=x(void 0,e),f=r.call(u,u),c=void 0;if(void 0!==f&&f!==u){if(u[h].modified)throw new Error(s);c=j(f),i&&(i.push({op:"replace",path:[],value:c}),a.push({op:"replace",path:[],value:e}))}else c=j(u,[],i,a);return w(E,function(e,r){return r.revoke()}),n&&n(i,a),c}finally{E=o}}(e,r,n):D(e,r,n)}R(function(i,a){for(var e=function(e){var n=a[e];if(0===n.path.length&&"replace"===n.op)i=n.value;else{var r=n.path.slice(),t=r.pop(),o=r.reduce(function(e,r){if(!e)throw new Error("Cannot apply patch, path doesn't resolve: "+n.path.join("/"));return e[r]},i);if(!o)throw new Error("Cannot apply patch, path doesn't resolve: "+n.path.join("/"));switch(n.op){case"replace":case"add":o[t]=n.value;break;case"remove":if(Array.isArray(o)){if(t!==o.length-1)throw new Error("Remove can only remove the last key of an array, index: "+t+", length: "+o.length);o.length-=1}else delete o[t];break;default:throw new Error("Unsupported patch operation: "+n.op)}}},r=0;r<a.length;r++)e(r);return i});var I=function(){function t(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),M=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},N=function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,r){var n=[],t=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(t=(a=u.next()).done)&&(n.push(a.value),!r||n.length!==r);t=!0);}catch(e){o=!0,i=e}finally{try{!t&&u.return&&u.return()}finally{if(o)throw i}}return n}(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")};e.createProvider=function(u,f,t){return function(e){function n(e){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,n);var o=function(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e)),r=u.initState,t=u.reduce;o.state=M({},r);var i=function(n){return new Promise(function(e){var r=R(o.state,function(e){t(e,n)},function(e,r){});o.setState(r,function(){e()})})},a=function(){return o.state};return o.actions={},Object.entries(f).forEach(function(e){var r=N(e,2),n=r[0],t=r[1];o.actions[n]=t(i,a)}),o}return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}(n,c.PureComponent),I(n,[{key:"render",value:function(){var e=t.Provider,r=M({},this.state,this.actions);return c.createElement(e,{value:r},this.props.children)}}]),n}()},e.map=function(n){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];return function(r){return function(){var e=n.Consumer;return c.createElement(e,null,function(n){var e=t.reduce(function(e,r){return e[r]=n[r],e},{});return c.createElement(r,e)})}}},e.multiMap=function(){var f=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];return function(u){return function(){var o=f.length,i=0,a={};return function e(r){var n=r.mapStore,t=r.context.Consumer;return i<o-1?(i++,c.createElement(t,null,function(r){return n.forEach(function(e){return a[e]=r[e]}),e(f[i])})):i===o-1?c.createElement(t,null,function(r){return n.forEach(function(e){return a[e]=r[e]}),c.createElement(u,a)}):void 0}(f[i])}}},Object.defineProperty(e,"__esModule",{value:!0})});
